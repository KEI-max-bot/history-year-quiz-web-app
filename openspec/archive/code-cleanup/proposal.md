# Proposal: コード全体のリファクタリング

## 目的

main.jsのコード品質を向上させ、保守性・拡張性を高める。

## 背景

現在のコードには以下の課題がある：

1. **ファイル構成**: 480行が1ファイルに集中
2. **XSS脆弱性**: innerHTML を複数箇所で使用（悪意のあるスクリプト注入リスク）
3. **グローバル変数**: 状態管理がグローバル変数に依存
4. **関数の責務**: 一部の関数が複数の責務を持つ

## 変更範囲

- フォルダ構成の見直し（機能別にファイル分割）
- main.js のリファクタリング
- セキュリティ改善（XSS対策: innerHTML → textContent）
- コード構造の整理

## 提案するフォルダ構成

```
src/
├── app.js           # エントリーポイント
├── state.js         # 状態管理
├── storage.js       # Local Storage操作
├── quiz.js          # クイズ機能
├── ui.js            # UI操作・レンダリング
└── utils.js         # ユーティリティ（formatYear等）
data/
└── sekaishi.js      # 年号データ
index.html
style.css
```

## 期待される効果

- セキュリティリスクの低減
- コードの可読性向上
- 将来の機能追加が容易に
- バグの発生リスク低減
- テストがしやすくなる

## リスク

- 既存機能への影響（十分なテストが必要）
- 動作確認の工数
